---
title: "Expresión Diferencial y Análisis Funcional de Pacientes con Psoriasis en Tratamiento con Glucocorticoides"
author: "Equipo 1"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown
---

# Descripción de los datos

## Equipo: #1

-   Integrantes:
-   Emiliano Ferro Rodríguez (eferro)
-   Jorge Alfredo Suazo Victoria (jsuazo)
-   Sofia Gamino Estrada (sgamino)

## Correos electrónicos de los integrantes:

-   Ferro: [emiferro\@comunidad.unam.mx](mailto:emiferro@comunidad.unam.mx)
-   Suazo: [jasvpj\@gmail.com](mailto:jasvpj@gmail.com)
-   Sofia: [ghobibohg\@gmail.com](mailto:ghobibohg@gmail.com)

## Descripción de los datos:

-   Bioproject: [PRJNA494527](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE120783)

-   Especie: *Homo sapiens*

-   Tipo de bibliotecas: Single-end

-   Método de selección: Total RNA

-   Número de transcriptomas: 34

-   Numero de replicas: 17 Replicas biologicas, con una replica tecnica por cada una ( Control y Firma génica inducida por glucocorticoides en la piel humana)

-   Secuenciador empleado: **Illumina NextSeq 500**

-   Distribución de las muestras: Control: 17 replicas de biopsias de piel de perforación de espesor completo (SRX4792843, SRX479284, SRX4792847, SRX4792849, SRX4792851, SRX4792853, SRX4792855, SRX4792857, SRX4792859, SRX4792861, SRX4792863, SRX4792865, SRX4792867, SRX4792869, SRX4792871, SRX4792873, SRX4792876)

-   Tratamiento: 17 muestras provientes de biopsias de piel tratadas con glucocorticoides (SRX4792844, SRX4792846, SRX4792848, SRX4792850, SRX4792852, SRX4792854, SRX4792856, SRX4792858, SRX4792860, SRX4792862, SRX4792864, SRX4792866, SRX4792868, SRX4792870, SRX4792872, SRX4792874, SRX4792875)

-   Profundidad de secuenciación de cada transcriptoma:

-   Control:

| Muestra    | Profundidad |
|------------|-------------|
| SRX4792843 | 21.3M       |
| SRX479284  | 17.6M       |
| SRX4792847 | 27.3M       |
| SRX4792849 | 25.1M       |
| SRX4792851 | 19M         |
| SRX4792853 | 31.5M       |
| SRX4792855 | 12.6M       |
| SRX4792857 | 12.2M       |
| SRX4792859 | 11.5M       |
| SRX4792861 | 36.2M       |
| SRX4792863 | 26M         |
| SRX4792865 | 24.7M       |
| SRX4792867 | 31.4M       |
| SRX4792869 | 27M         |
| SRX4792871 | 27.2M       |
| SRX4792873 | 28.9M       |
| SRX4792876 | 26.6M       |

-   Tratamiento:

| Muestra    | Profundidad |
|------------|-------------|
| SRX4792844 | 31.7M       |
| SRX4792846 | 29.3M       |
| SRX4792848 | 20.9M       |
| SRX4792850 | 40.7M       |
| SRX4792852 | 29.3M       |
| SRX4792854 | 23.6M       |
| SRX4792856 | 12.5M       |
| SRX4792858 | 13.5M       |
| SRX4792860 | 13.1M       |
| SRX4792862 | 24.6M       |
| SRX4792864 | 27.3M       |
| SRX4792866 | 29.4M       |
| SRX4792868 | 31.3M       |
| SRX4792870 | 24.1M       |
| SRX4792872 | 23.5M       |
| SRX4792874 | 24.6M       |
| SRX4792875 | 23.5M       |

-   Tamaño de las lecturas: 75 pb

-   Artículo científico: Sarkar MK, Kaplan N, Tsoi LC, Xing X et al. Endogenous Glucocorticoid Deficiency in Psoriasis Promotes Inflammation and Abnormal Differentiation. J Invest Dermatol 2017 Jul;137(7):1474-1483. PMID: [28259685](https://pubmed.ncbi.nlm.nih.gov/28259685/) Los datos se pueden descargar desde [NCBI](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE120783) o usando [ENA](https://www.ebi.ac.uk/ena/browser/view/PRJNA494527?show=publications).

# Abstract

En este estudio, comparamos la expresión génica en pacientes con psoriasis en tres tipos de muestras de piel: sana, lesional y no lesional. Además, analizamos los cambios en la expresión génica antes y 24 horas después del tratamiento con glucocorticoides para evaluar su impacto a corto plazo.

Para ello, se obtuvieron muestras de piel de 17 pacientes con psoriasis, generando un total de 34 transcriptomas. Se extrajo ARN total de cada muestra y se realizó secuenciación de ARN de alta resolución utilizando la plataforma Illumina NextSeq 500.

El estudio se basó en datos de expresión génica obtenidos mediante secuenciación de ARN (RNA-seq). Estos datos permiten cuantificar los niveles de transcripción de los genes en cada tipo de muestra y evaluar cómo varían en respuesta al tratamiento con glucocorticoides.

Para el análisis de los datos de RNA-seq, utilizamos el pipeline nf-core/rna-seq, implementado en Nextflow, debido a su reproducibilidad, escalabilidad y automatización en el procesamiento de datos de secuenciación. Este pipeline permite realizar pasos clave como control de calidad, alineación de lecturas y cuantificación de expresión génica de manera eficiente y estandarizada.

Posteriormente, realizamos un análisis de expresión diferencial con DESeq2, un paquete de R ampliamente utilizado en estudios transcriptómicos. Esta herramienta aplica modelos estadísticos para identificar genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides).

Para interpretar los cambios en la expresión génica, se realizó un análisis funcional utilizando Gene Ontology (GO), lo que permitió identificar los procesos biológicos más representados entre los genes diferencialmente expresados.

Además, se empleó KEGG para identificar las vías metabólicas en las que están involucrados estos genes. Este análisis permitió contextualizar los efectos del tratamiento con glucocorticoides dentro de rutas biológicas específicas, proporcionando una visión más completa de los mecanismos moleculares implicados en la psoriasis y su respuesta al tratamiento.

Los análisis de expresión diferencial revelaron que el tratamiento con glucocorticoides afecta genes involucrados en procesos antiinflamatorios y de diferenciación celular en la piel de pacientes con psoriasis.

Uno de los genes más regulados por los glucocorticoides fue TSC22D3, el cual desempeña un papel clave en la respuesta inmune y la diferenciación celular, sugiriendo su importancia en la acción del tratamiento.

Otro hallazgo relevante fue la regulación de MERTK, un receptor tirosina quinasa implicado en la resolución de la inflamación crónica, lo que refuerza su posible papel en la modulación de la psoriasis.

# Buenas practicas de Bioinformática

Nosotros usamos el pipeline de nf-core rna-seq, por lo cual tenemos como output muchos tipos de resultados. Tenemos varias carpetas, cada una con un proposito específico. Serán epxlicadas a continuación:

## Estructura General

```         
.
├── adapters
│   └── TruSeq3-SE.fa
├── Analisis
│   ├── Analisis.Rproj
│   ├── Data_Visualization.R
│   ├── DEG_Analysis.R
│   ├── GOterms_analysis.R
│   ├── index.Rmd
│   └── tables
├── data
│   ├── metadata.tsv
│   ├── processed
│   └── raw
├── DEG_output
│   └── deseq2_qc
├── quality1
│   └── multiqc_data
├── quality2
│   └── multiqc_data
├── reference
│   ├── gencode.v47.annotation.gtf.gz
│   └── hg38.fa -> /mnt/Archives/genome/human/GRCh38/UCSC/chromosomes/hg38.fa
├── results
│   ├── Analisis_diferencial
│   ├── fastp
│   ├── fastqc
│   ├── multiqc
│   ├── pipeline_info
│   └── star_salmon
├── SALMON_index
│   ├── complete_ref_lens.bin
│   ├── ctable.bin
│   ├── ctg_offsets.bin
│   ├── duplicate_clusters.tsv
│   ├── info.json
│   ├── mphf.bin
│   ├── pos.bin
│   ├── pre_indexing.log
│   ├── rank.bin
│   ├── refAccumLengths.bin
│   ├── ref_indexing.log
│   ├── reflengths.bin
│   ├── refseq.bin
│   ├── seq.bin
│   └── versionInfo.json
├── SALMON_output
│   ├── salmon.merged.gene_counts_length_scaled.rds
│   ├── salmon.merged.gene_counts_length_scaled.tsv
│   ├── salmon.merged.gene_counts.rds
│   ├── salmon.merged.gene_counts_scaled.rds
│   ├── salmon.merged.gene_counts_scaled.tsv
│   ├── salmon.merged.gene_counts.tsv
│   ├── salmon.merged.gene_lengths.tsv
│   ├── salmon.merged.gene_tpm.tsv
│   ├── salmon.merged.transcript_counts.rds
│   ├── salmon.merged.transcript_counts.tsv
│   ├── salmon.merged.transcript_lengths.tsv
│   ├── salmon.merged.transcript_tpm.tsv
│   └── tx2gene.tsv
├── scripts
│   ├── cache
│   ├── jobs
│   ├── out_logs
│   ├── r_scripts
│   ├── samplesheet.csv
│   └── work
├── STAR_index
│   ├── chrLength.txt
│   ├── chrNameLength.txt
│   ├── chrName.txt
│   ├── chrStart.txt
│   ├── exonGeTrInfo.tab
│   ├── exonInfo.tab
│   ├── geneInfo.tab
│   ├── Genome
│   ├── genomeParameters.txt
│   ├── Log.out
│   ├── SA
│   ├── SAindex
│   ├── sjdbInfo.txt
│   ├── sjdbList.fromGTF.out.tab
│   ├── sjdbList.out.tab
│   └── transcriptInfo.tab
├── STAR_output
└── TRIM_results
```

# Diagrama de flujo

# Resultados

## Calidad de secuencias

### Secuencias Crudas

![](images/clipboard-3184264068.png)

![](images/clipboard-4021843613.png)

![](images/clipboard-4236530129.png)

![](images/clipboard-3539655336.png)

![](images/clipboard-2910841059.png)

![](images/clipboard-263100148.png)

![](images/clipboard-63839139.png)

![](images/clipboard-3338401574.png)

![](images/clipboard-546568783.png)

### Secuencias Procesadas

![](images/clipboard-3592789900.png)

![](images/clipboard-15205712.png)

## Limpieza de adaptadores

## Alineamiento de secuencia

## Predicción de cuentas

## Expresión diferencial

Utilizando el .Rdata que el pipeline de nf-core/rnaseq generó, se realizó un análisis de expresión diferencial utilizando el paquete DESeq2. Este análisis permite identificar genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides).

Se utilizo ademas la metadata (Tabla 5-1) para realizar un analisis de expresión diferencial entre las muestras de control y tratamiento con glucocorticoides.

```{r echo=FALSE, message=FALSE, warning=FALSE}
table <- read.table("metadata.tsv", header = TRUE, sep = "\t")
knitr::kable(table, format = "markdown", caption = "Tabla 5-1: Metadata de las muestras de control y tratamiento con glucocorticoides (GC)")
```

Apartir de esto se modifico el objeto dds anteriormente creado con el pipeline de nextflow para que contenga la metadata y que incluya las variables que queremos observar, en este caso el tratamiento y el tipo de muestra. Se utilizo el paquete `DESeq2` para realizar el analisis de expresión diferencial, usando la función `DESeq()` ejecutamos el analisis de expresion diferencial para posteriormente realizar una transformacion de varianza estabilizada (VST), es una técnica que ajusta los datos para hacer que la varianza sea más homogénea entre diferentes niveles de expresión.

Para identificar patrones en los datos, se realizó un análisis de componentes principales (PCA) sobre la matriz normalizada. El PCA es una técnica estadística que reduce la dimensionalidad de los datos y permite visualizar la variabilidad en las muestras. Se utilizaron las variables `Type` (tratamiento) y `Condition` (La condición de la piel) para observar cómo se distribuyen las muestras en el espacio de componentes principales.

![Figura 5-1: La figura muestra un Análisis de Componentes Principales (PCA) basado en datos transformados mediante VST (Variance Stabilizing Transformation), donde los puntos representan muestras clasificadas según la condición de la piel y el tipo de tratamiento. La condición de la piel se indica con colores: rojo para piel saludable, verde para piel con lesión y azul para piel no lesionada, mientras que el tipo de muestra se diferencia por la forma: círculos para controles y triángulos para muestras tratadas con glucocorticoides. Las distribuciones marginales en los ejes permiten observar la variabilidad y agrupamiento de las muestras en los primeros dos componentes principales (PC1 y PC2). En cuanto a la distribución según el tratamiento, se observa que las muestras tratadas con glucocorticoides (triángulos) tienden a agruparse en valores positivos de PC2, mientras que las muestras de control (círculos) están distribuidas en un rango más amplio de PC2, con una mayor presencia en valores negativos. Esto sugiere que el tratamiento con glucocorticoides está asociado con una variabilidad específica capturada en PC2, diferenciándose de las muestras de control en esta dimensión del espacio de componentes principales. Además se observa que las muestras saludables (rojo) tienden a agruparse en valores positivos de PC1, mientras que las muestras lesionadas (verde) y no lesionadas (azul) se concentran en valores negativos de PC1, con una mayor superposición entre estas dos últimas, lo que sugiere que las muestras lesionadas y no lesionadas son más similares entre sí en este espacio de representación que respecto a las muestras saludables.
](results/figures/PCA_vsdata.png)


<br>

Los resultados de la funcion `results()` del paquete `DESeq2` nos permiten observar los genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides). 
<div style="border: 2px solid #9F2142; border-radius: 10px; padding: 10px; margin: 15px;">

```{}
out of 50781 with nonzero total read count
adjusted p-value < 0.1
LFC > 0 (up)       : 661, 1.3%
LFC < 0 (down)     : 667, 1.3%
outliers [1]       : 672, 1.3%
low counts [2]     : 30935, 61%
(mean count < 6)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results
```
<div style="text-align:center; text-size: 10;">Chunk 1: Se identificaron un total de 1.328 genes (661 sobreexpresados + 667 subexpresados) que muestran cambios significativos en respuesta al tratamiento con glucocorticoides. 672 genes fueron atipicos, estos son genes que mostraron patrones de expresión extremos o inconsistentes. El 61% restante corresponde a genes con conteos bajos, lo que indica que no se detectaron suficientes lecturas para realizar un análisis confiable de su expresión.</div>
</div>
La cantidad de genes diferencialmente expresados se puede ver de una mejor manera en el volcano plot (Figura 5-2).

![Figura 5-2: Volcano plot que muestra la relación entre el log2 del cociente de las medias de expresión (log2FoldChange) y el valor p ajustado (-log10(padj)) para los genes analizados. Los puntos en la parte derecha representa a los genes sobreexpresados, mientras que la parte izquierda son los genes subexpresados. El color gris representa la insignificancia de los genes.](results/figures/VolcanoPlotGCvsControl.png)


<br>
Viendo esto podemos hacer un heatmap (Figura 5-3) para identificar cuales son los genes que se encuentran sobreexpresados y subexpresados en las muestras tratadas con glucocorticoides. 
En los resultados coinciden con la idea de que los glucocorticoides tienen un efecto antiinflamatorio, ya que se observa una disminución en la expresión de genes relacionados con la inflamación y la respuesta inmune. Los que vamos a tomar en cuenta para este reporte son: **GLUL**, **TSC22D3**, **BEST2**, **LAMA2** y **DKK1**.

![Figura 5-3: Heatmap que muestra la expresión de los genes diferencialmente expresados en las muestras tratadas con glucocorticoides. Los colores indican la magnitud de la expresión, donde el rojo representa una mayor expresión y el azul una menor expresión.](results/figures/Heatmap_vsd_topgenes.png)

## Analisis funcional

# Discusión

# Citas y referencias

<https://www.sciencedirect.com/science/article/pii/S0022202X1931629X>

<https://www.sciencedirect.com/science/article/pii/S0040816621000859>
