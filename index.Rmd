---
title: "Expresión Diferencial y Análisis Funcional de Pacientes con Psoriasis en Tratamiento con Glucocorticoides"
author: "Equipo 1"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown
---

# Descripción de los datos

## Equipo: #1

-   Integrantes:
-   Emiliano Ferro Rodríguez (eferro)
-   Jorge Alfredo Suazo Victoria (jsuazo)
-   Sofia Gamino Estrada (sgamino)

## Correos electrónicos de los integrantes:

-   Ferro: [emiferro\@comunidad.unam.mx](mailto:emiferro@comunidad.unam.mx)
-   Suazo: [jasvpj\@gmail.com](mailto:jasvpj@gmail.com)
-   Sofia: [ghobibohg\@gmail.com](mailto:ghobibohg@gmail.com)

## Descripción de los datos:

-   Bioproject: [PRJNA494527](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE120783)

-   Especie: *Homo sapiens*

-   Tipo de bibliotecas: Single-end

-   Método de selección: Total RNA

-   Número de transcriptomas: 34

-   Numero de replicas: 17 Replicas biologicas, con una replica tecnica por cada una ( Control y Firma génica inducida por glucocorticoides en la piel humana)

-   Secuenciador empleado: **Illumina NextSeq 500**

-   Distribución de las muestras: Control: 17 replicas de biopsias de piel de perforación de espesor completo (SRX4792843, SRX479284, SRX4792847, SRX4792849, SRX4792851, SRX4792853, SRX4792855, SRX4792857, SRX4792859, SRX4792861, SRX4792863, SRX4792865, SRX4792867, SRX4792869, SRX4792871, SRX4792873, SRX4792876)

-   Tratamiento: 17 muestras provientes de biopsias de piel tratadas con glucocorticoides (SRX4792844, SRX4792846, SRX4792848, SRX4792850, SRX4792852, SRX4792854, SRX4792856, SRX4792858, SRX4792860, SRX4792862, SRX4792864, SRX4792866, SRX4792868, SRX4792870, SRX4792872, SRX4792874, SRX4792875)

-   Profundidad de secuenciación de cada transcriptoma:

-   Control:

| Muestra    | Profundidad |
|------------|-------------|
| SRX4792843 | 21.3M       |
| SRX479284  | 17.6M       |
| SRX4792847 | 27.3M       |
| SRX4792849 | 25.1M       |
| SRX4792851 | 19M         |
| SRX4792853 | 31.5M       |
| SRX4792855 | 12.6M       |
| SRX4792857 | 12.2M       |
| SRX4792859 | 11.5M       |
| SRX4792861 | 36.2M       |
| SRX4792863 | 26M         |
| SRX4792865 | 24.7M       |
| SRX4792867 | 31.4M       |
| SRX4792869 | 27M         |
| SRX4792871 | 27.2M       |
| SRX4792873 | 28.9M       |
| SRX4792876 | 26.6M       |

-   Tratamiento:

| Muestra    | Profundidad |
|------------|-------------|
| SRX4792844 | 31.7M       |
| SRX4792846 | 29.3M       |
| SRX4792848 | 20.9M       |
| SRX4792850 | 40.7M       |
| SRX4792852 | 29.3M       |
| SRX4792854 | 23.6M       |
| SRX4792856 | 12.5M       |
| SRX4792858 | 13.5M       |
| SRX4792860 | 13.1M       |
| SRX4792862 | 24.6M       |
| SRX4792864 | 27.3M       |
| SRX4792866 | 29.4M       |
| SRX4792868 | 31.3M       |
| SRX4792870 | 24.1M       |
| SRX4792872 | 23.5M       |
| SRX4792874 | 24.6M       |
| SRX4792875 | 23.5M       |

-   Tamaño de las lecturas: 75 pb

-   Artículo científico: Sarkar MK, Kaplan N, Tsoi LC, Xing X et al. Endogenous Glucocorticoid Deficiency in Psoriasis Promotes Inflammation and Abnormal Differentiation. J Invest Dermatol 2017 Jul;137(7):1474-1483. PMID: [28259685](https://pubmed.ncbi.nlm.nih.gov/28259685/) Los datos se pueden descargar desde [NCBI](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE120783) o usando [ENA](https://www.ebi.ac.uk/ena/browser/view/PRJNA494527?show=publications).

# Abstract

En este estudio, comparamos la expresión génica en pacientes con psoriasis en tres tipos de muestras de piel: sana, lesional y no lesional. Además, analizamos los cambios en la expresión génica antes y 24 horas después del tratamiento con glucocorticoides para evaluar su impacto a corto plazo.

Para ello, se obtuvieron muestras de piel de 17 pacientes con psoriasis, generando un total de 34 transcriptomas. Se extrajo ARN total de cada muestra y se realizó secuenciación de ARN de alta resolución utilizando la plataforma Illumina NextSeq 500.

El estudio se basó en datos de expresión génica obtenidos mediante secuenciación de ARN (RNA-seq). Estos datos permiten cuantificar los niveles de transcripción de los genes en cada tipo de muestra y evaluar cómo varían en respuesta al tratamiento con glucocorticoides.

Para el análisis de los datos de RNA-seq, utilizamos el pipeline nf-core/rna-seq, implementado en Nextflow, debido a su reproducibilidad, escalabilidad y automatización en el procesamiento de datos de secuenciación. Este pipeline permite realizar pasos clave como control de calidad, alineación de lecturas y cuantificación de expresión génica de manera eficiente y estandarizada.

Posteriormente, realizamos un análisis de expresión diferencial con DESeq2, un paquete de R ampliamente utilizado en estudios transcriptómicos. Esta herramienta aplica modelos estadísticos para identificar genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides).

Para interpretar los cambios en la expresión génica, se realizó un análisis funcional utilizando Gene Ontology (GO), lo que permitió identificar los procesos biológicos más representados entre los genes diferencialmente expresados.

Además, se empleó KEGG para identificar las vías metabólicas en las que están involucrados estos genes. Este análisis permitió contextualizar los efectos del tratamiento con glucocorticoides dentro de rutas biológicas específicas, proporcionando una visión más completa de los mecanismos moleculares implicados en la psoriasis y su respuesta al tratamiento.

Los análisis de expresión diferencial revelaron que el tratamiento con glucocorticoides afecta genes involucrados en procesos antiinflamatorios y de diferenciación celular en la piel de pacientes con psoriasis.

Uno de los genes más regulados por los glucocorticoides fue TSC22D3, el cual desempeña un papel clave en la respuesta inmune y la diferenciación celular, sugiriendo su importancia en la acción del tratamiento.

Otro hallazgo relevante fue la regulación de MERTK, un receptor tirosina quinasa implicado en la resolución de la inflamación crónica, lo que refuerza su posible papel en la modulación de la psoriasis.

# Buenas prácticas de Bioinformática

Nosotros usamos **nf-core rnaseq**, por lo cual la estructura de nuestras carpetas cambiará un poco, pero explicaremos cada una para que no queden dudas.

## Estructura general

```         
├── adapters
│   └── TruSeq3-SE.fa
├── data
│   ├── metadata.tsv
│   └── raw
├── DEG_output
│   └── deseq2_qc
│       ├── deseq2.dds.RData
│       ├── deseq2.pca.vals.txt
│       ├── deseq2.plots.pdf
│       ├── deseq2.sample.dists.txt
│       ├── R_sessionInfo.log
│       └── size_factors
├── quality1
│   ├── multiqc_data
│   ├── multiqc_report.html
│   ├── SRR7959221_fastqc.zip
│   ├── SRR7959222_fastqc.html
│   └── ...
├── quality2
│   ├── aaF1_fastqc.html
│   ├── aaF1_fastqc.zip
│   ├── ...
│   ├── multiqc_data
│   └── multiqc_report.html
├── reference
│   ├── gencode.v47.annotation.gtf.gz
│   └── hg38.fa -> /mnt/Archives/genome/human/GRCh38/UCSC/chromosomes/hg38.fa
├── results
│   ├── Analisis_diferencial
│       ├── dds_TypesnCondition.RData
│       ├── DE_GCvsControl.csv
│       ├── DE_LesionalGC.csv
│       ├── DE_LesionalvsHealthy.csv
│       ├── DE_NonlesionalGC.csv
│       ├── DE_NonLesionalvsHealthy.csv
│       ├── DOWN_GO_GCvsControl.RData
│       ├── figures
│       ├── UP_GO_GCvsControl.RData 
│       └── vst_TypesnCondition.RData
│   ├── fastp
│       ├── aaF1.fastp.html
│       ├── aaF1.fastp.json
│       ├── ...
│       └── log
│           ├── aaF1.fastp.log
│           └── ...
│   ├── fastqc
│       ├── aaF1_fastqc.html
│       ├── aaF1_fastqc.zip
│       ├── ...
│       └── raw
│           ├── aaF1_GC_raw_fastqc.html
│           └── ...
│   ├── multiqc
│       └── star_salmon
│           ├── multiqc_report_data
│           ├── multiqc_report.html
│           └── multiqc_report_plots
│   ├── pipeline_info
│       ├── execution_report_2025-03-25_20-19-09.html`
│       ├── execution_timeline_2025-03-25_20-19-09.html
│       ├── execution_trace_2025-03-25_20-19-09.txt
│       ├── params_2025-03-25_23-40-42.json
│       ├── pipeline_dag_2025-03-25_20-19-09.html
│       ├── samplesheet.valid.csv
│       └── software_versions.yml
│   └── star_salmon
│       ├── aaF1_GC
│           ├── aux_info
│           ├── cmd_info.json
│           ├── libParams
│           ├── logs
│           ├── quant.genes.sf
│           └── quant.sf
│       ├── aaF1_GC.markdup.sorted.bam
│       ├── aaF1_GC.markdup.sorted.bam.bai
│       ├── ...
│       ├── log
│       ├── picard_metrics
│       ├── qualimap
│       ├── rseqc
│       ├── salmon.merged.gene_counts* #Con esto me refiero a que hay varios archivos de cuentas de salmon.
│       ├── samtools_stats
│       ├── stringtie
│       └── tx2gene.tsv
├── SALMON_index
├── SALMON_output
│   ├── aaF1
│       ├── aux_info
│       ├── cmd_info.json
│       ├── libParams
│       ├── logs
│       ├── quant.genes.sf
│       └── quant.sf
│   ├── ... #Las otras carpetas también son por cada muestra, y son exactamente iguales a la anterior
│   ├── salmon.merged.gene_counts.tsv
│   ├── salmon.merged.*   # Con el * nos referimos a que hay varios archivos que son de las cuentas de salmon.
│   └── tx2gene.tsv
├── scripts
│   ├── cache
│       ├── .nextflow
│       ├── .singularity
│       ├── .singularitynxf
│       ├── .singularitytmp
│       └── .work
│   ├── jobs
│       ├── download_data.sge
│       ├── fastqcs_raw.sge
│       ├── job_quality_raw.sge
│       └── nextflow_rna_seq_fastp.sge
│   ├── out_logs
│       ├── Download_data.o978805
│       ├── Download_data.po978805
│       └── nextflow_test1.o988120
│   ├── r_scripts
│       ├── Analisis.Rproj
│       ├── Data_Visualization.R
│       ├── DEG_Analysis.R
│       ├── GOterms_analysis.R
│       ├── index.html
│       ├── index.Rmd
│       ├── results.zip
│       ├── .Rhistory
│       ├── .Rproj.user
│       └── tables
│   ├── samplesheet.csv
│   └── work
│       ├── 00
│       ├── ...       # El resto son igual, son directorios aislados donde se ejecutan los procesos.
├── STAR_index
├── STAR_output
│   ├── aaF1_GC.markdup.sorted.bam
│   ├── aaF1_GC.markdup.sorted.bam.bai
│   └──  ...  # Los demás archivos son los mismo pero para las demás muestras.
└── TRIM_results
    ├── aaF1_GC.fastp.fastq.gz
    └── ... # Los demás fastqs procesados.
```

### Adapters

En esta carpeta está vacia porque **fastp detecta los adaptadores automaticamente**, por lo cual no había necesidad de descargarlos de internet.

### Data

Aquí tenemos nuestros datos crudos de las muestras, así como los metadastos de estas.

-   `metadata.tsv` : Son los metadatos

-   `raw` : Aqui van los fastqs de las muestras sin procesar.

### DEG_output

Aquí se encuentra la información de los genes diferencialmente expresados. Para hacerlo, nf-core uso **DESeq2**.

-   `deseq2.pca.vals.txt`\`: Son los valores asignados en el PCA a cada muestra.

-   `deseq2.plots.pdf`\`: Aquí encontramos las gráficas creadas por deseq2 en donde se hacen PCAs de las muestras en donde se toman en cuenta los 500 genes más importantes, y con todos los genes. También encontramos un heatmap de las distancias euclideanas entre las muestras según los genes diferencialmente expresados.

-   `deseq2.sample.dists.txt`\`: Aquí estan las distancias euclideanas entre muestras.

-   `deseq2.dds.RData`\`: Este es un objeto de deseq que usamos el el análisis diferencial.

-   `size_factors`\`: Esta es una carpeta donde se encuentran los pesos de cada muestra para que la diferencia en reads no afecte el análisis diferencial. Ref: <https://www.biostars.org/p/359060/>

### quality1

Aquí estan los fastqc de las muestras crudas, sin procesar. Hay un fastqc.html y un fastqc.zip por muestra, y un multiqc que abarca todas las muestras.

-   Lo que **no salió del pipeline de nf-core rnaseq son los datos de multiqc**, esos fueron creados por nosotros aparte.

### quality2

Aquí estan los fastqc de las muestras procesadas con fastp. Hay un fastqc.html y un fastqc.zip por muestra, y un multiqc que abarca todas las muestras. Es importante mencionar que estos fastqc **salieron del pipeline de nf-core rnaseq**, y aparte que nuestras muestras crudas parecian no tener adaptadores.

-   Lo que **no salió del pipeline de nf-core rnaseq son los datos de multiqc**, esos fueron creados por nosotros aparte.

### reference

En esta carpeta cargamos el archivo GTF del genoma humanohg38.fa, de ensembl. También añadimos la ruta al fasta del genoma humano.

### results

Esta es una carepta muy amplia, que contiene todos los outputs del pipeline de nf-core rnaseq. Se explicará cada output bervemente a continuación:

#### Analisis_Diferencial

Esta es la única carpeta que no proviene del pipeline de nf-core, y que fue creada por nosotros para poner los outputs (figuras, csvs) del análisis diferencial que hicimos en R.

#### fastp

Esta carpeta contiene el análisis de fastp de cada muestra, así como sus logs y fastqc.

-   Fastp nos da un html que nos puede ayudar a medir la calidad de nuestros datos, muy parecido a fastqc. Estos estan en el formato muestra.fastp.html y muestra.fastp.json.
-   La otra carpeta es `log` . Esta carpeta contiene toda la información de como fue el procesado de cada muestra (número de reads debajo de un threshold de calidad, reads totales, etc), y tiene la estructura muestra.log.
-   Por último, tenemos una carpeta `fastqc`\`, donde están los fastqcs de las muestras procesadas por fastp. **Estos fastqc son los que pusimos en la carpeta quality2**.

#### fastqc

Esta carpeta es un poco parecida a la de fastp, solo que se centra en los fastqc. Al entrar, tienes los mismos fastqc procesados por fastp que se mencionaron en la viñeta anterior (son los mismos que están en quality2), pero también tenemos la carpeta `raw`\`.

-   En la carpeta `raw`\`tenemos los fastqcs pero de los datos crudos. **Estos son los fastqcs que están en la carpeta quality1**, y tienen la estructura muestra.fastqc.html y muestra.fastqc.zip

#### multiqc

En esta carpeta tenemos un multiqc creado por **nf-core** que resume los datos provenientes de la carepta **star_salmon**.

-   `star_salmon/multiqc_report_data`\`: Aquí están los datos con los que se creó el multiqc. Provienen de los resultados de star_salmon.

-   `star_salmon/multiqc_report.html`\`: Este es el reporte que se puede abrir en tu navegador.

-   `star_salmon/multiqc_report_plots`\`: Estos son los plots que aparecen en el reporte.

#### pipeline_info

Esta carpeta es muy útil, ya que **nos permite saber como es que el pipeline de nf-core rnaseq progresó**. Aquí podemos ver errores, warnings, y también el directorio de `work`\`donde se realizaron los procesos, para cada uno.

-   `execution_report_2025-03-25_20-19-09.html`\`: Este html nos da un reporte general de como fue el pipeline. Si hay errores o el pipe fue exitoso, se puede checar aquí. También se peude checar el uso de memoria por proceso.

-   `execution_timeline_2025-03-25_20-19-09.html`\`: Este es muy similar al anterior, solo que nos da una linea del tiempo.

-   `execution_trace_2025-03-25_20-19-09.txt`\`: Este es un archivo **vital**, ya que nos permite saber **donde (nos da un directorio de la carpeta work) y cuando se realizó cada proceso del pipeline de nf-core, así como su progresión (para saber si hubieron errores)**.

-   `samplesheet.valid.csv`\`: Esta solo es una copia del samplesheet que hicimos (se mencionara más adelante).

#### star_salmon

Esta es la carpeta con más información de todos los resultados de nextflow, ya que aquí podemos encontrar los resultados de la ejecución de los programas **Salmon** y **STAR**. También están aquí los resultados de **DESeq2**, así como muchas otras métricas que nos dan más información del estado de las reads de cada muestra.

-   Vas a observar una carpeta por cada
# Diagrama de flujo

# Resultados

## Calidad de secuencias

### Secuencias Crudas

![](images/clipboard-3184264068.png)

![](images/clipboard-4021843613.png)

![](images/clipboard-4236530129.png)

![](images/clipboard-3539655336.png)

![](images/clipboard-2910841059.png)

![](images/clipboard-263100148.png)

![](images/clipboard-63839139.png)

![](images/clipboard-3338401574.png)

![](images/clipboard-546568783.png)

### Secuencias Procesadas

![](images/clipboard-3592789900.png)

![](images/clipboard-15205712.png)

## Limpieza de adaptadores

## Alineamiento de secuencia

## Predicción de cuentas

## Expresión diferencial

Utilizando el .Rdata que el pipeline de nf-core/rnaseq generó, se realizó un análisis de expresión diferencial utilizando el paquete DESeq2. Este análisis permite identificar genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides).

Se utilizo ademas la metadata (Tabla 5-1) para realizar un analisis de expresión diferencial entre las muestras de control y tratamiento con glucocorticoides.

```{r echo=FALSE, message=FALSE, warning=FALSE}
table <- read.table("metadata.tsv", header = TRUE, sep = "\t")
knitr::kable(table, format = "markdown", caption = "Tabla 5-1: Metadata de las muestras de control y tratamiento con glucocorticoides (GC)")
```

Apartir de esto se modifico el objeto dds anteriormente creado con el pipeline de nextflow para que contenga la metadata y que incluya las variables que queremos observar, en este caso el tratamiento y el tipo de muestra. Se utilizo el paquete `DESeq2` para realizar el analisis de expresión diferencial, usando la función `DESeq()` ejecutamos el analisis de expresion diferencial para posteriormente realizar una transformacion de varianza estabilizada (VST), es una técnica que ajusta los datos para hacer que la varianza sea más homogénea entre diferentes niveles de expresión.

Para identificar patrones en los datos, se realizó un análisis de componentes principales (PCA) sobre la matriz normalizada. El PCA es una técnica estadística que reduce la dimensionalidad de los datos y permite visualizar la variabilidad en las muestras. Se utilizaron las variables `Type` (tratamiento) y `Condition` (La condición de la piel) para observar cómo se distribuyen las muestras en el espacio de componentes principales.

![Figura 5-1: La figura muestra un Análisis de Componentes Principales (PCA) basado en datos transformados mediante VST (Variance Stabilizing Transformation), donde los puntos representan muestras clasificadas según la condición de la piel y el tipo de tratamiento. La condición de la piel se indica con colores: rojo para piel saludable, verde para piel con lesión y azul para piel no lesionada, mientras que el tipo de muestra se diferencia por la forma: círculos para controles y triángulos para muestras tratadas con glucocorticoides. Las distribuciones marginales en los ejes permiten observar la variabilidad y agrupamiento de las muestras en los primeros dos componentes principales (PC1 y PC2). En cuanto a la distribución según el tratamiento, se observa que las muestras tratadas con glucocorticoides (triángulos) tienden a agruparse en valores positivos de PC2, mientras que las muestras de control (círculos) están distribuidas en un rango más amplio de PC2, con una mayor presencia en valores negativos. Esto sugiere que el tratamiento con glucocorticoides está asociado con una variabilidad específica capturada en PC2, diferenciándose de las muestras de control en esta dimensión del espacio de componentes principales. Además se observa que las muestras saludables (rojo) tienden a agruparse en valores positivos de PC1, mientras que las muestras lesionadas (verde) y no lesionadas (azul) se concentran en valores negativos de PC1, con una mayor superposición entre estas dos últimas, lo que sugiere que las muestras lesionadas y no lesionadas son más similares entre sí en este espacio de representación que respecto a las muestras saludables.
](results/figures/PCA_vsdata.png)


<br>

Los resultados de la funcion `results()` del paquete `DESeq2` nos permiten observar los genes que presentan cambios significativos en su expresión entre las diferentes condiciones del estudio (antes y después del tratamiento con glucocorticoides). 
<div style="border: 2px solid #9F2142; border-radius: 10px; padding: 10px; margin: 15px;">

```{}
out of 50781 with nonzero total read count
adjusted p-value < 0.1
LFC > 0 (up)       : 661, 1.3%
LFC < 0 (down)     : 667, 1.3%
outliers [1]       : 672, 1.3%
low counts [2]     : 30935, 61%
(mean count < 6)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results
```
<div style="text-align:center; text-size: 10;">Chunk 1: Se identificaron un total de 1.328 genes (661 sobreexpresados + 667 subexpresados) que muestran cambios significativos en respuesta al tratamiento con glucocorticoides. 672 genes fueron atipicos, estos son genes que mostraron patrones de expresión extremos o inconsistentes. El 61% restante corresponde a genes con conteos bajos, lo que indica que no se detectaron suficientes lecturas para realizar un análisis confiable de su expresión.</div>
</div>
La cantidad de genes diferencialmente expresados se puede ver de una mejor manera en el volcano plot (Figura 5-2).

![Figura 5-2: Volcano plot que muestra la relación entre el log2 del cociente de las medias de expresión (log2FoldChange) y el valor p ajustado (-log10(padj)) para los genes analizados. Los puntos en la parte derecha representa a los genes sobreexpresados, mientras que la parte izquierda son los genes subexpresados. El color gris representa la insignificancia de los genes.](results/figures/VolcanoPlotGCvsControl.png)


<br>
Viendo esto podemos hacer un heatmap (Figura 5-3) para identificar cuales son los genes que se encuentran sobreexpresados y subexpresados en las muestras tratadas con glucocorticoides. 
En los resultados coinciden con la idea de que los glucocorticoides tienen un efecto antiinflamatorio, ya que se observa una disminución en la expresión de genes relacionados con la inflamación y la respuesta inmune. Los que vamos a tomar en cuenta para este reporte son: **GLUL**, **TSC22D3**, **BEST2**, **LAMA2** y **DKK1**.

![Figura 5-3: Heatmap que muestra la expresión de los genes diferencialmente expresados en las muestras tratadas con glucocorticoides. Los colores indican la magnitud de la expresión, donde el rojo representa una mayor expresión y el azul una menor expresión.](results/figures/Heatmap_vsd_topgenes.png)

## Analisis funcional

# Discusión

# Citas y referencias

<https://www.sciencedirect.com/science/article/pii/S0022202X1931629X>

<https://www.sciencedirect.com/science/article/pii/S0040816621000859>
